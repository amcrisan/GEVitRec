---
title: "GEViTRec"
author: "Anamaria Crisan"
date: '2019-02-01'
output: html_document
---


## Loading data
```{r}
devtools::load_all() #temporary once things are done

#Table data
tab_dat<-input_data(file = system.file("./inst/extdata/", "ebov_metadata.csv", package = "epivis"),dataType = "table")

#Tree data
tree_dat<-input_data(file = system.file("./inst/extdata/", "ebov_tree.nwk", package = "epivis"),dataType = "tree")

#Genomic data
genomic_dat<-input_data(file = system.file("./inst/extdata/", "ebov_GIN_genomic.fasta", package = "epivis"),dataType = "dna")

#Shape files
#Shape files require that .shp,.shx,and .prj files at a minimun to be in the same directory
#to add metadata to the shape file, you can also add .dbf files
gin_shape_dat<-input_data(file = system.file("./inst/extdata/", "gin_admbnda_adm1_ocha_itos.shp", package = "epivis"),dataType = "spatial")
lbr_shape_dat<-input_data(file = system.file("./inst/extdata/", "lbr_admbnda_adm1_ocha.shp", package = "epivis"),dataType = "spatial")
sle_shape_dat<-input_data(file = system.file("./inst/extdata/", "sle_admbnda_adm1_1m_gov_ocha_20161017.shp",package = "epivis"),dataType = "spatial")
```

## Data Harmonization
```{r}
harmon_obj<-data_harmonization(tab_dat,tree_dat,genomic_dat,gin_shape_dat,lbr_shape_dat,sle_shape_dat)
```

It's possible to view the entityt graph of how all of the data sources are linked together
```{r}
view_entity_graph(harmon_obj[["entityGraph"]])
```

It's also possible to filter according to the strength of the jaccard distance strength. A strength of 1 means that two variables in different datasets are effectively the same (have set equality), whereas 0 means that they have nothing in common.
```{r}
view_entity_graph(subset_graph(harmon_obj[["entityGraph"]],1))
```

## Chart Recommendations

With the data harmonized, it is possible to generate specifications for different charts. It possible to use the whole graph too.

```{r}
tmp<-get_spec_list(harmon_obj)
```

```{r}
harmon_obj_sub<-harmon_obj
harmon_obj_sub[["entityGraph"]]<-subset_graph(harmon_obj_sub[["entityGraph"]],1)
tmp<-get_spec_list(harmon_obj_sub,usrChoices = c("country","year"))
clean_up_spec(tmp)
```